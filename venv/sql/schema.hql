-- Schema for Mutual Fund Data
Create Table IMDB.MF(
  SHARECLASS_ID	String,
  SHARECLASS_NAME	String,
  FUND_NAME	String,
  SHARE_CLASS_COUNTER	Int,
  FUND_FAMILY_NAME	String,
  MSTAR_CATEGORY_NAME	String,
  MSTAR_GLOB_CATEGORY_NAME	String,
  MSTAR_BROAD_CATEGORY	String,
  COMMON_SOURCE_SYSTEM	String,
  RETURN_NET_1M	String,
  RETURN_NET_2M	String,
  RETURN_NET_3M	String,
  RETURN_NET_6M	Double,
  RETURN_NET_1Y	Double,
  RETURN_NET_2Y	Double,
  RETURN_NET_3Y	Double,
  RETURN_NET_4Y	Double,
  RETURN_NET_5Y	Double )
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LINE TERMINATED BY '\n'
STORED AS TEXTFILE;


-- Schema for ETF Data
Create Table IMDB.ETF(
SHARECLASS_ID	String,
SHARECLASS_NAME	String,
FUND_NAME	String,
CATEGORY	String,
SHARPE_RATIO_1Y	Int,
SHARPE_RATIO_3Y	Int,
SHARPE_RATIO_5Y	Int,
BETA_1Y	Int,
BETA_3Y	Int,
BETA_5Y	Int,
INFO_RATIO_3Y	Int,
INFO_RATIO_5Y	Int )
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINE TERMINATED BY '\n' STORED AS TEXTFILE
LOCATION '';


-- SQL Query
Select mf.FUND_NAME,avg(ef.INFO_RATIO_5Y)
from mutual_funds_data mf join  et_funds_data ef
on mf.SHARECLASS_ID = ef.SHARECLASS_ID
Where mf.SHARE_CLASS_COUNTER > 1
group by mf.FUND_NAME;


